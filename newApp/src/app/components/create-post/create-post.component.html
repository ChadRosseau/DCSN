<div class="wrapper">
    <h1>Create Article</h1>
    <div class="hero">
        <form [formGroup]="createArticleForm">
            <div class="categoriesContainer">
                <select [formControl]="createArticleForm.controls.category" (change)="ngOnInit()"
                    [style.backgroundColor]="sharedData.colors.categories[createArticleForm.value.category]">
                    <option value="" selected disabled hidden>- Select Category -</option>
                    <option [value]="category" *ngFor="let category of sharedData.categories">
                        {{category}}
                    </option>
                </select>
                <mat-error *ngIf="createArticleForm.controls.category.hasError('required')" [hidden]="!showErrors"
                    class="error">
                    Category is required
                </mat-error>

                <select [formControl]="createArticleForm.controls.subcategory"
                    [style.backgroundColor]="sharedData.colors.subcategories[createArticleForm.value.category]"
                    [attr.disabled]="createArticleForm.value.category == '' ? '' : null">
                    <option value="" selected disabled hidden>
                        {{ createArticleForm.value.category == "" ? '- Please select a category -' : "- Select Subcategory -" }}
                    </option>
                    <option [value]=" subcategory"
                        *ngFor="let subcategory of sharedData.subcategories[createArticleForm.value.category]">
                        {{subcategory}}
                    </option>
                </select>
                <mat-error *ngIf="createArticleForm.controls.subcategory.hasError('required')" [hidden]="!showErrors"
                    class="error">
                    Subcategory is required
                </mat-error>
            </div>

            <mat-form-field class="title">
                <textarea [formControl]="createArticleForm.controls.title" type="text"
                    placeholder="Your article title here"
                    [style.border]="createArticleForm.value.title != '' ? 'none' : '1px solid #000'"></textarea>
                <mat-error *ngIf="createArticleForm.controls.title.hasError('required')" [hidden]="!showErrors"
                    class="error">
                    Title is required
                </mat-error>
            </mat-form-field>

            <hr>

            <div class="authorContainer">
                <div class="authorPfp"
                    [style.backgroundImage]="writerInfo ? 'url(' + writerInfo.photoURL + ')' : 'none'">
                </div>
                <p class="authorName">{{writerInfo ? writerInfo.displayName : 'Name loading...'}}</p>
                <p class="timestamp">{{time != {} ? time['displayTime'] : 'DD Month YYYY'}}</p>
            </div>

            <mat-form-field class="subtitle">
                <textarea [formControl]="createArticleForm.controls.subtitle" type="text"
                    placeholder="Your article subtitle here"
                    [style.border]="createArticleForm.value.subtitle != '' ? 'none' : '1px solid #000'"></textarea>
                <mat-error *ngIf="createArticleForm.controls.subtitle.hasError('required')" [hidden]="!showErrors"
                    class="error">
                    Subtitle is required
                </mat-error>
            </mat-form-field>

            <mat-form-field class="thumbURL">
                <div class="thumbWrapper" [style.height]="createArticleForm.value.thumbURL != '' ? '300px' : '30px'">
                    <input [formControl]="createArticleForm.controls.thumbURL" type="url" name=""
                        placeholder="Thumbnail Image URL: (https://www.imageurl.com)"
                        (input)="imageExists(createArticleForm.value.thumbURL)" />
                    <mat-error *ngIf="createArticleForm.controls.thumbURL.hasError('required')" [hidden]="!showErrors"
                        class="error">
                        Thumbnail URL is required
                    </mat-error>
                    <div class="thumbURLPreview" [style.backgroundImage]="currentImage"
                        [style.display]="createArticleForm.value.thumbURL != '' ? 'block' : 'none'"></div>
                </div>
            </mat-form-field>

            <!-- <h5>Thumbnail:</h5>
    <input [(ngModel)]="newArticle.title"type="file" id="fileUpload" name="" /> -->

            <!-- <h5>Video Link:</h5>
    <input type="text" name="" /> -->


            <editor [formControl]="createArticleForm.controls.body" content="Body text of the article"
                apiKey="yx8a3up6w2hnadnvmm5ntt1ryttjrdbddr7yjpdh4dm3kg92" [init]="tinymceInit">
            </editor>

            <div class="buttonsWrapper">
                <button [routerLink]="['/']">Discard Article Draft</button>
                <button (click)="createArticle('creating')">Save Article Draft</button>
                <button (click)="createArticle('moderating')">Submit for Moderation</button>
            </div>
        </form>

    </div>
</div>